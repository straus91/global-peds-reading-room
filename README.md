# Global Peds Reading Room

An educational web platform designed for global pediatric radiology learning and practice. This platform allows medical professionals to view curated radiology cases, submit diagnostic reports, receive AI-powered feedback, and compare their interpretations against expert findings using standardized templates.

## Project Overview

The Global Peds Reading Room aims to provide an interactive learning environment where users can:
- Browse and select radiology cases across various subspecialties and modalities.
- View DICOM images for selected cases using an embedded OHIF viewer connected to an Orthanc DICOM server.
- Submit structured diagnostic reports based on provided master templates.
- Receive automated, AI-generated feedback on their submitted reports by comparing them to expert interpretations, powered by Google Gemini.
- Compare their reports against expert-filled language-specific templates.
- Track their progress and learning.

Administrators can:
- Manage users, including registration approvals.
- Create, edit, and manage teaching cases, including linking them to DICOM studies in Orthanc.
- Manage master report templates and expert-filled language versions of these templates.
- Configure system settings.

## Key Features Implemented (MVP)
- User registration and authentication (with admin approval workflow).
- Admin panel for managing users, cases, and report templates.
- User-facing interface to list and view case details.
- DICOM image viewing via an embedded Orthanc OHIF viewer.
- Structured report submission by users based on master templates.
- Display of user's own submitted report alongside expert analysis.
- **AI-Powered Feedback:** Users can request and receive feedback on their reports, generated by Google Gemini, comparing their findings to expert reports.

## Quick Start

### Prerequisites
- Python 3.8+
- PostgreSQL
- Node.js (currently no frontend build step, but good for potential future tooling)
- An Orthanc DICOM server instance (for DICOM image hosting).
- A Google Gemini API Key (for AI feedback feature).

### Backend Setup (`backend/` directory)
1. Create a Python virtual environment: `python -m venv venv`
2. Activate the virtual environment:
   - Windows PowerShell: `.\venv\Scripts\Activate.ps1`
   - Windows cmd: `venv\Scripts\activate.bat`
   - macOS/Linux: `source venv/bin/activate`
3. Install dependencies: `pip install -r requirements.txt`
4. Create a `.env` file in the `backend/` directory (from `.env.example` if provided, or create new). Add your `DATABASE_URL`, `SECRET_KEY`, and `GEMINI_API_KEY`.
   Example `backend/.env`:
   ```env
   SECRET_KEY="your_strong_secret_key_here"
   DEBUG="True"
   ALLOWED_HOSTS="localhost,127.0.0.1"
   # Database Example (PostgreSQL)
   DB_NAME="globalpeds_db"
   DB_USER="your_db_user"
   DB_PASSWORD="your_db_password"
   DB_HOST="localhost"
   DB_PORT="5432"
   # Gemini API Key
   GEMINI_API_KEY="your_google_gemini_api_key"
   # CORS Origins for frontend dev server
   CORS_ALLOWED_ORIGINS="[http://127.0.0.1:5500](http://127.0.0.1:5500),http://localhost:5500"
5. Configure database connection details in backend/globalpeds_project/settings.py if not fully covered by .env.
6. Run database migrations: python manage.py migrate (this will include migrations for the orthanc_study_uid field).
7. Create a superuser (admin account): python manage.py createsuperuser
8. Run the Django development server: python manage.py runserver (Usually at http://127.0.0.1:8000/)
## Frontend Setup (frontend/ directory)
1. Vanilla JavaScript, HTML, and CSS. No build step is currently required.
2. Ensure API_CONFIG.BASE_URL in frontend/js/api.js points to your running backend (default http://127.0.0.1:8000/api).
3. Ensure your local Orthanc server (with OHIF plugin) is running and accessible (default http://localhost:8042).The orthancOhifViewerBaseUrl in frontend/js/main.js viewCase function may need adjustment if your Orthanc OHIF path is different.
4. Serve the frontend directory using a simple HTTP server:
### Bash
### cd frontend
### python -m http.server 5500 
Then access the application, typically starting at http://127.0.0.1:5500/login.html.

## Project Structure
global-peds-reading-room/
├── backend/                  # Django backend
│   ├── cases/                # Core app: Case mgt, Templates, Reports, DICOM UID, LLM service
│   ├── users/                # User authentication & profiles
│   ├── globalpeds_project/   # Django project settings & main URLs
│   ├── api/                  # Main API routing & some auth views
│   ├── .env                  # (NOT COMMITTED) Environment variables (DB, API keys)
│   ├── manage.py
│   └── requirements.txt
├── frontend/                 # Vanilla JS frontend
│   ├── admin/                # HTML & JS for admin interface pages
│   ├── assets/               # Images, icons
│   ├── css/                  # CSS stylesheets
│   ├── js/                   # JavaScript files (main.js, auth.js, api.js, admin scripts)
│   └── login.html            # Login/Registration page
│   └── index.html            # Main user-facing page after login
├── docs/                     # Project documentation
└── .gitignore
└── README.md                 # This file

## Documentation
- [Architecture Overview](docs/ARCHITECTURE.md)
- [Project Map (File & API Structure)](docs/PROJECT_MAP.md)
- [Development Guide](docs/DEVELOPMENT.md)
- [Deployment Guide](docs/DEPLOYMENT.md)
- [Changelog](docs/CHANGELOG.md)
- [AI Assistant Guide](docs/AI_GUIDE.md) (for collaborators interacting with AI dev assistants)

## Recent Key Updates (Reflecting Current MVP State - May 14, 2025)
### Core Features Implemented:
- DICOM Viewing MVP: Cases can be linked to DICOM studies in an external Orthanc server (via StudyInstanceUID), and users can view these images using an embedded Orthanc OHIF viewer within the case details page.
- AI-Powered Report Feedback (Gemini) MVP: Backend infrastructure established to use Google Gemini for generating feedback on user-submitted reports by comparing them against expert reports. Users can request this feedback from the case view page.
- User registration (admin approval) & JWT authentication.
Admin panel for management of Users, Cases (including DICOM linking), and Master Report Templates.
- User ability to view cases, submit structured reports, and see their own report alongside expert analysis.
### Critical Bugs Fixed & Refinements:
- Resolved various login redirection path issues.
- Corrected "Add Language Version" flow in admin case creation, including draft saving and dropdown population.
- Ensured reliable loading and configuration of the Gemini API key.
- Addressed NameError in LLM service and issues with API response model name for Gemini.
- For a complete list of changes, see CHANGELOG.md.

## For AI Developers (and human collaborators!)
When making significant changes:
1. Update this README with a summary of key new features or critical fixes.
2. Add detailed entries to [docs/CHANGELOG.md](docs/CHANGELOG.md).
3. If the project's architecture or file/API structure changes, update [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md) and [docs/PROJECT_MAP.md](docs/PROJECT_MAP.md) accordingly.
4. Ensure new code is well-commented, especially new or complex functions.